{"version":3,"file":"22.js","mappings":"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","sources":["webpack://@dev/app/../talks/src/services/Service.ts","webpack://@dev/app/../talks/src/services/BrowserService.ts","webpack://@dev/app/../talks/src/services/HelloService.ts","webpack://@dev/app/../talks/src/services/MessagesService.ts","webpack://@dev/app/../talks/src/services/SensorService.ts","webpack://@dev/app/../talks/src/services/VideoService.ts","webpack://@dev/app/../talks/src/services/RemoteService.ts","webpack://@dev/app/../talks/src/services/index.ts","webpack://@dev/app/../web/src/containers/Sensor/index.tsx","webpack://@dev/app/../web/src/containers/Sensor/styles.module.scss","webpack://@dev/app/../web/src/containers/Sensor/styles.module.scss?7c0d"],"sourcesContent":["import { GraphQLClient } from \"graphql-request\";\nimport { createClient } from \"graphql-ws\";\n\n// https://shammelburg.medium.com/subscriptions-with-graphql-dfa8279af050\n// https://github.com/shammelburg/graphql-rxjs-angular/blob/main/src/app/services/graphql.service.ts\nconst client = new GraphQLClient(`${location.pathname}graphql`, {\n  headers: {\n    // authorization: `Bearer ${localStorage.getItem('token')}`,\n  },\n});\n\nconst subscriptions = createClient({\n  url: `${{ \"https:\": \"wss:\" }[location.protocol] || \"ws:\"}//${location.host}${\n    location.pathname\n  }subscriptions`,\n});\n\nexport class Service {\n  client = client;\n  subscriptions = subscriptions;\n}\n","import { gql } from \"graphql-request\";\nimport { from } from \"rxjs\";\nimport { Service } from \"./Service\";\n\nconst FILES = gql`\n  query {\n    files {\n      name\n    }\n  }\n`;\n\nexport class BrowserService extends Service {\n  files() {\n    return from(this.client.request(FILES));\n  }\n}\n","import { gql } from \"graphql-request\";\nimport { from } from \"rxjs\";\nimport { Service } from \"./Service\";\n\nconst HELLO = gql`\n  query {\n    hello\n  }\n`;\n\nexport class HelloService extends Service {\n  hello() {\n    return from(this.client.request(HELLO));\n  }\n}\n","import { gql } from \"graphql-request\";\nimport { from, Observable } from \"rxjs\";\nimport { Service } from \"./Service\";\n\nconst MESSAGES = gql`\n  query MessagesQuery {\n    messages {\n      uuid\n      text\n    }\n  }\n`;\n\nconst ON_MESSAGE = gql`\n  subscription MessageSubscription {\n    message {\n      uuid\n      text\n    }\n  }\n`;\n\nconst SEND_MESSAGE = gql`\n  mutation SendMessageMutation($message: MessageInput) {\n    sendMessage(message: $message)\n  }\n`;\n\n// https://github.com/shammelburg/graphql-rxjs-angular/blob/main/src/app/services/graphql.service.ts\n// https://codesandbox.io/s/push-based-react-lab-3-vc8d6?file=/src/users/state/users.service.ts\n// https://jasonwatmore.com/post/2020/04/21/react-hooks-rxjs-communicating-between-components-with-observable-subject\nexport class MessagesService extends Service {\n  getMessages() {\n    return from(this.client.request(MESSAGES));\n  }\n  sendMessage(message) {\n    return from(this.client.request(SEND_MESSAGE, { message }));\n  }\n  onMessage() {\n    return new Observable((observer) =>\n      this.subscriptions.subscribe(\n        { query: ON_MESSAGE },\n        {\n          next: ({ data, errors }) =>\n            errors ? observer.error(errors[0]) : observer.next(data),\n          error: (error) => observer.error(error),\n          complete: () => observer.complete(),\n        }\n      )\n    );\n  }\n}\n","import { gql } from \"graphql-request\";\nimport { Observable } from \"rxjs\";\nimport { Service } from \"./Service\";\n\nconst ON_SENSOR = gql`\n  subscription SensorSubscription {\n    sensor {\n      data\n    }\n  }\n`;\n\nexport class SensorService extends Service {\n  onSensor() {\n    return new Observable((observer) =>\n      this.subscriptions.subscribe(\n        { query: ON_SENSOR },\n        {\n          next: ({ data, errors }) =>\n            errors ? observer.error(errors[0]) : observer.next(data),\n          error: (error) => observer.error(error),\n          complete: () => observer.complete(),\n        }\n      )\n    );\n  }\n}\n","import { gql } from \"graphql-request\";\nimport { from, Observable } from \"rxjs\";\nimport { Service } from \"./Service\";\n\nconst ON_SIGNAL = gql`\n  subscription SignalSubscription {\n    signal {\n      sdp\n      type\n      candidate {\n        candidate\n        sdpMLineIndex\n        sdpMid\n      }\n    }\n  }\n`;\n\nconst SEND_SIGNAL = gql`\n  mutation SendSignalMutation($signal: SignalInput) {\n    sendSignal(signal: $signal)\n  }\n`;\n\nexport class VideoService extends Service {\n  sendSignal(signal) {\n    return from(this.client.request(SEND_SIGNAL, { signal }));\n  }\n  onSignal() {\n    return new Observable((observer) =>\n      this.subscriptions.subscribe(\n        { query: ON_SIGNAL },\n        {\n          next: ({ data, errors }) =>\n            errors ? observer.error(errors[0]) : observer.next(data),\n          error: (error) => observer.error(error),\n          complete: () => observer.complete(),\n        }\n      )\n    );\n  }\n}\n","import { gql } from \"graphql-request\";\nimport { from, Observable } from \"rxjs\";\nimport { Service } from \"./Service\";\n\nconst GET_DEVICES = gql`\n  query GetDevicesQuery {\n    devices {\n      data\n    }\n  }\n`;\n\nconst REMOTE = gql`\n  query RemoteQuery {\n    remote {\n      data\n    }\n  }\n`;\n\nconst REMOTE_RCU = gql`\n  query RemoteTvQuery($key: String) {\n    remoteRcu(key: $key) {\n      data\n    }\n  }\n`;\n\nconst REMOTE_TV = gql`\n  query RemoteTvQuery($action: String) {\n    remoteTv(action: $action) {\n      data\n    }\n  }\n`;\n\nconst REMOTE_VCR = gql`\n  query RemoteVcrQuery($action: String) {\n    remoteVcr(action: $action) {\n      data\n    }\n  }\n`;\n\nconst ON_REMOTE = gql`\n  subscription RemoteSubscription {\n    remote {\n      data\n    }\n  }\n`;\n\nconst SEND_REMOTE = gql`\n  mutation SendRemoteMutation($remote: RemoteInput) {\n    sendRemote(remote: $remote)\n  }\n`;\n\ntype RcuKey = \"KeyStandBy\" | \"KeyVolumeDown\" | \"KeyVolumeUp\";\n\nexport class RemoteService extends Service {\n  getDevices() {\n    return from(this.client.request(GET_DEVICES));\n  }\n  getMessages() {\n    return from(this.client.request(REMOTE));\n  }\n  getRemoteRcu(key: RcuKey) {\n    return from(this.client.request(REMOTE_RCU, { key }));\n  }\n  getRemoteTv(action) {\n    return from(this.client.request(REMOTE_TV, { action }));\n  }\n  getRemoteVcr(action) {\n    return from(this.client.request(REMOTE_VCR, { action }));\n  }\n  sendMessage(data) {\n    return from(this.client.request(SEND_REMOTE, { data }));\n  }\n  onMessage() {\n    return new Observable((observer) =>\n      this.subscriptions.subscribe(\n        { query: ON_REMOTE },\n        {\n          next: ({ data, errors }) =>\n            errors ? observer.error(errors[0]) : observer.next(data.remote),\n          error: (error) => observer.error(error),\n          complete: () => observer.complete(),\n        }\n      )\n    );\n  }\n}\n","import { useEffect, useState } from \"react\";\nimport { BrowserService } from \"./BrowserService\";\nimport { HelloService } from \"./HelloService\";\nimport { MessagesService } from \"./MessagesService\";\nimport { SensorService } from \"./SensorService\";\nimport { VideoService } from \"./VideoService\";\n\nexport * from \"./RemoteService\";\n\nconst helloService = new HelloService();\n\nexport function useHello() {\n  const [state, setState] = useState({ hello: null });\n\n  useEffect(() => {\n    const subscriptions = [\n      helloService\n        .hello()\n        .subscribe(({ hello }) => setState((state) => ({ ...state, hello }))),\n    ];\n    return () => {\n      subscriptions.map((it) => it.unsubscribe());\n    };\n  }, []);\n\n  return [state];\n}\n\nconst messageService = new MessagesService();\n\n// https://codesandbox.io/s/push-based-react-lab-3-vc8d6?file=/src/users/hooks/users.hook.ts\nexport function useMessages() {\n  const [{ messages }, setState] = useState(() => ({\n    messages: null,\n  }));\n\n  useEffect(() => {\n    const subscriptions = [\n      messageService\n        .getMessages()\n        .subscribe(({ messages }) =>\n          setState((state) => ({ ...state, messages }))\n        ),\n      messageService.onMessage().subscribe(({ message }) =>\n        setState(({ messages, ...state }) => ({\n          ...state,\n          messages: messages.concat([message]),\n        }))\n      ),\n    ];\n    return () => {\n      subscriptions.map((it) => it.unsubscribe());\n    };\n  }, []);\n\n  return [\n    { messages },\n    { sendMessage: (message) => messageService.sendMessage(message) },\n  ];\n}\n\nconst sensorService = new SensorService();\n\nexport function useSensor() {\n  const [{ values }, setState] = useState(() => ({\n    values: null,\n  }));\n\n  useEffect(() => {\n    const subscriptions = [\n      sensorService.onSensor().subscribe(({ sensor }) =>\n        setState(({ values, ...state }) => ({\n          ...state,\n          values: (values || []).concat([sensor]),\n        }))\n      ),\n    ];\n    return () => {\n      subscriptions.map((it) => it.unsubscribe());\n    };\n  }, []);\n\n  return [{ values }, {}];\n}\n\nconst videoService = new VideoService();\n\nexport function useVideo() {\n  const [state, setState] = useState({ hello: null });\n\n  useEffect(() => {\n    const subscriptions = [\n      videoService\n        .onSignal()\n        .subscribe(({ signal }) => setState((state) => ({ ...state, signal }))),\n    ];\n    return () => {\n      subscriptions.map((it) => it.unsubscribe());\n    };\n  }, []);\n\n  return [state, { sendSignal: (signal) => videoService.sendSignal(signal) }];\n}\n\nconst browserService = new BrowserService();\n\nexport function useFiles() {\n  const [state, setState] = useState({ files: null });\n\n  useEffect(() => {\n    const subscriptions = [\n      browserService\n        .files()\n        .subscribe(({ files }) => setState((state) => ({ ...state, files }))),\n    ];\n    return () => {\n      subscriptions.map((it) => it.unsubscribe());\n    };\n  }, []);\n\n  return [state];\n}\n","import React, { MouseEventHandler, useCallback, useEffect } from \"react\";\nimport { useSensor } from \"@dev/talks/src/services\";\nimport styles from \"./styles.module.scss\";\n\n// https://github.com/atc1441/atc1441.github.io/blob/master/TelinkFlasher.html\nconst addLog = console.log;\nconst addClog = addLog;\nconst setStatus = addLog;\n\nfunction handleError(error) {\n  console.error(error);\n  // resetVariables();\n  // if (connectTrys < 5) {\n  //     connectTrys++;\n  //     addLog(\"Reconnect \" + connectTrys + \" from \" + 5);\n  //     doConnect();\n  // } else {\n  //     addLog(\"Something went wrong, to many reconnect's\");\n  //     connectTrys = 0;\n  // }\n}\n\nfunction onDisconnected() {\n  console.log(\"Disconnected.\");\n}\n\nfunction catchAdvertisement(device) {\n  const abortController = new AbortController();\n  device.addEventListener(\n    \"advertisementreceived\",\n    (event) => {\n      console.log('Received advertisement from \"' + device.name + '\"...');\n      event.serviceData.forEach((valueDataView) => {\n        const buffer = new Uint8Array(valueDataView.buffer);\n        console.log(buffer, device, event);\n        if (device.name == \"LYWSD03MMC\") {\n          console.log(\n            \"LYWSD03MMC MAC:\",\n            buffer[10].toString(16),\n            buffer[9].toString(16),\n            buffer[8].toString(16),\n            buffer[7].toString(16),\n            buffer[6].toString(16),\n            buffer[5].toString(16)\n          );\n          document.getElementById(\"MAC\").innerHTML =\n            \"LYWSD03MMC MAC: \" +\n            buffer[10].toString(16) +\n            buffer[9].toString(16) +\n            buffer[8].toString(16) +\n            buffer[7].toString(16) +\n            buffer[6].toString(16) +\n            buffer[5].toString(16);\n        }\n        if (device.name.startsWith(\"ATC\")) {\n          console.log(\n            \"ATC MAC:\",\n            buffer[0].toString(16),\n            buffer[1].toString(16),\n            buffer[2].toString(16),\n            buffer[3].toString(16),\n            buffer[4].toString(16),\n            buffer[5].toString(16)\n          );\n          document.getElementById(\"MAC\").innerHTML =\n            \"ATC MAC: \" +\n            buffer[0].toString(16) +\n            buffer[1].toString(16) +\n            buffer[2].toString(16) +\n            buffer[3].toString(16) +\n            buffer[4].toString(16) +\n            buffer[5].toString(16);\n        } else {\n          console.log(\"only LYWSD03MMC/ATC supported\");\n        }\n      });\n      abortController.abort();\n    },\n    { once: true }\n  );\n}\n\nlet ServiceMain;\nlet writeCharacteristicSpeed;\nlet nitifiyCharTemp;\n\nfunction miAction() {\n  gattServer\n    .getPrimaryService(\"ebe0ccb0-7a0a-4b0c-8a1a-6ff2997da3a6\")\n    .then((service) => {\n      addClog(\"Found Main service\");\n      ServiceMain = service;\n      return ServiceMain.getCharacteristic(\n        \"ebe0ccd8-7a0a-4b0c-8a1a-6ff2997da3a6\"\n      );\n    })\n    .then((characteristic) => {\n      addClog(\"Found Write characteristic Speed\");\n      writeCharacteristicSpeed = characteristic;\n      return ServiceMain.getCharacteristic(\n        \"ebe0ccc1-7a0a-4b0c-8a1a-6ff2997da3a6\"\n      );\n    })\n    .then((characteristic) => {\n      addClog(\"Found Temp characteristic\");\n      nitifiyCharTemp = characteristic;\n      return nitifiyCharTemp.startNotifications().then(() => {\n        nitifiyCharTemp.addEventListener(\n          \"characteristicvaluechanged\",\n          (event) => {\n            var value = event.target.value;\n            console.log({ value });\n            var sign = value.getUint8(1) & (1 << 7);\n            var temp = ((value.getUint8(1) & 0x7f) << 8) | value.getUint8(0);\n            if (sign) temp = temp - 32767;\n            temp = temp / 100;\n            var hum = value.getUint8(2);\n            var tempTempString = \"Temp/Humi: \" + temp + \"°C / \" + hum + \"%\";\n            document.getElementById(\"tempHumiData\").innerHTML = tempTempString;\n            addClog(tempTempString);\n          }\n        );\n        // miAuthorization()\n      });\n    })\n    .catch(handleError);\n}\n\nlet bluetoothDevice = null;\nlet gattServer;\nlet Theservice;\nlet writeCharacteristic;\n\nfunction doConnect() {\n  bluetoothDevice.gatt\n    .connect()\n    .then((server) => {\n      addClog(\"Found GATT server\");\n      gattServer = server;\n      return gattServer.getPrimaryService(\n        \"00010203-0405-0607-0809-0a0b0c0d1912\"\n      );\n    })\n    .then((service) => {\n      addClog(\"Found service\");\n      Theservice = service;\n      return Theservice.getCharacteristic(\n        \"00010203-0405-0607-0809-0a0b0c0d2b12\"\n      );\n    })\n    .then((characteristic) => {\n      addClog(\"Found write characteristic\");\n      writeCharacteristic = characteristic;\n      detectMi();\n    })\n    .catch(handleError);\n}\n\nlet miEnabled;\nlet customEnabled;\n\nfunction detectMi() {\n  gattServer\n    .getPrimaryServices()\n    .then((services) => {\n      miEnabled = false;\n      customEnabled = false;\n      for (var i = 0; i < services.length; i++) {\n        console.log(\"Services: \" + services[i].uuid);\n        if (services[i].uuid == \"ebe0ccb0-7a0a-4b0c-8a1a-6ff2997da3a6\")\n          miEnabled = true;\n        if (services[i].uuid == \"00001f10-0000-1000-8000-00805f9b34fb\")\n          customEnabled = true;\n      }\n      if (miEnabled) {\n        addLog(\"Detected Mi Thermometer\");\n        setStatus(\"Detected Mi Thermometer\");\n        miAction();\n      } else if (customEnabled) {\n        addLog(\"Detected custom Firmware\");\n        setStatus(\"Detected custom Firmware\");\n        // customAction();\n      } else {\n        addLog(\"Connected\");\n        setStatus(\"Connected\");\n      }\n    })\n    .catch(handleError);\n}\n\nexport default function Sensor() {\n  const [{ values }] = useSensor();\n  console.log({ values });\n\n  useEffect(() => {}, []);\n\n  const onReconnect = useCallback<MouseEventHandler<HTMLButtonElement>>(\n    (event) => {\n      if (bluetoothDevice !== null) bluetoothDevice.gatt.disconnect();\n      // resetVariables();\n      addLog(\"Reconnect\");\n      // connectTrys = 0;\n      doConnect();\n    },\n    []\n  );\n\n  const onConnect = useCallback<MouseEventHandler<HTMLButtonElement>>(\n    (event) => {\n      // https://developer.mozilla.org/en-US/docs/Web/API/Bluetooth/requestDevice\n      const deviceOptions = {\n        filters: [\n          { name: \"LYWSD03MMC\" },\n          {\n            services: [0xfe95],\n          },\n          // {\n          //   services: [\n          //     \"00010203-0405-0607-0809-0a0b0c0d1912\",\n          //     \"ebe0ccb0-7a0a-4b0c-8a1a-6ff2997da3a6\",\n          //     0xfe95,\n          //     0x1f10,\n          //   ],\n          // },\n        ],\n        optionalServices: [\n          \"00010203-0405-0607-0809-0a0b0c0d1912\",\n          \"ebe0ccb0-7a0a-4b0c-8a1a-6ff2997da3a6\",\n          0xfe95,\n          0x1f10,\n        ],\n        // acceptAllDevices: true,\n      };\n      navigator.bluetooth.getAvailability().then((availability) => {\n        if (availability) {\n          // https://developer.mozilla.org/en-US/docs/Web/API/BluetoothCharacteristicProperties#examples\n          navigator.bluetooth\n            .requestDevice(deviceOptions)\n            .then((device) => {\n              console.log({ device });\n              bluetoothDevice = device;\n              catchAdvertisement(device);\n              bluetoothDevice.addEventListener(\n                \"gattserverdisconnected\",\n                onDisconnected\n              );\n              addLog(\"Connecting to: \" + bluetoothDevice.name);\n              doConnect();\n            })\n            .catch(handleError);\n        }\n      });\n    },\n    []\n  );\n\n  return (\n    <section className={styles.Section}>\n      <span>LYWSD03MMC</span>\n      <button onClick={onConnect}>Connect</button>\n      <button onClick={onReconnect}>Reconnect</button>\n      <span id=\"tempHumiData\"></span>\n      <span id=\"MAC\"></span>\n      {values === null ? (\n        <div>Loading...</div>\n      ) : (\n        values.map((item, key) => <div key={key}>{JSON.stringify(item)}</div>)\n      )}\n    </section>\n  );\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".BUVMpFXG9cmk5ZtAw0Oh{color:purple}\", \"\",{\"version\":3,\"sources\":[\"webpack://./../web/src/containers/Sensor/styles.module.scss\"],\"names\":[],\"mappings\":\"AAAA,sBACE,YAAA\",\"sourcesContent\":[\".Section {\\n  color: purple;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"Section\": \"BUVMpFXG9cmk5ZtAw0Oh\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","\n      import API from \"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./styles.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\nif (module.hot) {\n  if (!content.locals || module.hot.invalidate) {\n    var isEqualLocals = function isEqualLocals(a, b, isNamedExport) {\n  if (!a && b || a && !b) {\n    return false;\n  }\n\n  var p;\n\n  for (p in a) {\n    if (isNamedExport && p === \"default\") {\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n\n    if (a[p] !== b[p]) {\n      return false;\n    }\n  }\n\n  for (p in b) {\n    if (isNamedExport && p === \"default\") {\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n\n    if (!a[p]) {\n      return false;\n    }\n  }\n\n  return true;\n};\n    var isNamedExport = !content.locals;\n    var oldLocals = isNamedExport ? namedExport : content.locals;\n\n    module.hot.accept(\n      \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./styles.module.scss\",\n      function () {\n        if (!isEqualLocals(oldLocals, isNamedExport ? namedExport : content.locals, isNamedExport)) {\n                module.hot.invalidate();\n\n                return;\n              }\n\n              oldLocals = isNamedExport ? namedExport : content.locals;\n\n              update(content);\n      }\n    )\n  }\n\n  module.hot.dispose(function() {\n    update();\n  });\n}\n\n\nexport * from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./styles.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n"],"names":["client","GraphQLClient","location","pathname","headers","subscriptions","createClient","url","protocol","host","Service","FILES","gql","HELLO","MESSAGES","ON_MESSAGE","SEND_MESSAGE","ON_SENSOR","ON_SIGNAL","SEND_SIGNAL","GET_DEVICES","REMOTE","REMOTE_RCU","REMOTE_TV","REMOTE_VCR","ON_REMOTE","SEND_REMOTE","RemoteService","getDevices","from","this","request","getMessages","getRemoteRcu","key","getRemoteTv","action","getRemoteVcr","sendMessage","data","onMessage","Observable","observer","subscribe","query","next","errors","error","remote","complete","helloService","hello","useHello","state","setState","useState","useEffect","map","it","unsubscribe","messageService","message","useMessages","messages","concat","sensorService","onSensor","useSensor","values","sensor","videoService","sendSignal","signal","onSignal","useVideo","browserService","files","useFiles","addLog","console","log","addClog","setStatus","handleError","onDisconnected","ServiceMain","writeCharacteristicSpeed","nitifiyCharTemp","gattServer","Theservice","writeCharacteristic","miEnabled","customEnabled","bluetoothDevice","doConnect","gatt","connect","then","server","getPrimaryService","service","getCharacteristic","characteristic","getPrimaryServices","services","i","length","uuid","startNotifications","addEventListener","event","value","target","sign","getUint8","temp","tempTempString","document","getElementById","innerHTML","catch","Sensor","onReconnect","useCallback","disconnect","onConnect","deviceOptions","filters","name","optionalServices","navigator","bluetooth","getAvailability","availability","requestDevice","device","abortController","AbortController","serviceData","forEach","valueDataView","buffer","Uint8Array","toString","startsWith","abort","once","catchAdvertisement","className","styles","onClick","id","item","JSON","stringify","___CSS_LOADER_EXPORT___","push","module","locals","options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","update","hot","invalidate","isNamedExport","oldLocals","accept","a","b","p","isEqualLocals","dispose","undefined"],"sourceRoot":""}