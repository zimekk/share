{"version":3,"file":"408.js","mappings":"oJAKO,MAAMA,EAAS,IAAIC,EAAAA,GAAe,GAAEC,SAASC,kBAAmB,CACrEC,QAAS,KAKEC,GAAgBC,EAAAA,EAAAA,IAAa,CACxCC,IAAM,GAAE,CAAE,SAAU,QAASL,SAASM,WAAa,UAAUN,SAASO,OACpEP,SAASC,2B,6GCKb,MAAMO,EAAiBC,EAAAA,EAAI;;;;;;EAgBrBC,EAAU,IART,cAbP,MACEZ,OAASA,EAAAA,EACTK,cAAgBA,EAAAA,GAYhBQ,cAAcC,GACZ,OAAOC,EAAAA,EAAAA,GAAKC,KAAKhB,OAAOiB,QAAQP,EAAgBI,IAAOI,MACrDC,EAAAA,EAAAA,IAAI,EAAGC,QAAUC,QAAAA,MAAgBA,OAmBxB,SAASC,IACtB,MAAOC,EAAMC,IAAWC,EAAAA,EAAAA,WAAS,KAAM,CACrCC,SAAqC,GACrCC,SAAqC,QAEjC,KAAEb,EAAI,cAAED,GAjBT,WACL,MAAOC,EAAMc,IAAWH,EAAAA,EAAAA,UAAS,IAEjC,MAAO,CACLX,KAAAA,EACAD,eAAegB,EAAAA,EAAAA,cACZf,GAASF,EAAQC,cAAcC,GAAMgB,WAAWhB,GAASc,EAAQd,MAClE,KAU4BiB,GAE1BC,GAAeH,EAAAA,EAAAA,cACnB,EAAGI,OAAAA,KACDT,GAASD,IAAI,IACRA,EACH,CAACU,EAAOC,MAAOD,EAAOE,WAE1B,IAGIC,GAAeP,EAAAA,EAAAA,cAAkDQ,IACrEA,EAAEC,iBACFzB,EAAcU,KACb,IAEH,OACEgB,EAAAA,cAAA,OAAKC,UAAWC,EAAAA,EAAAA,SACdF,EAAAA,cAAA,UAAI,UACJA,EAAAA,cAAA,QAAMG,SAAUN,GACdG,EAAAA,cAAA,aACEA,EAAAA,cAAA,WAAK,YACLA,EAAAA,cAAA,SACEL,KAAK,WACLS,KAAK,OACLR,MAAOZ,EAAKG,SACZkB,SAAUZ,KAGdO,EAAAA,cAAA,aACEA,EAAAA,cAAA,WAAK,YACLA,EAAAA,cAAA,SACEL,KAAK,WACLS,KAAK,OACLR,MAAOZ,EAAKI,SACZiB,SAAUZ,KAGdO,EAAAA,cAAA,WACEA,EAAAA,cAAA,UAAQI,KAAK,UAAS,iBAG1BJ,EAAAA,cAAA,WAAMM,KAAKC,UAAUhC,EAAM,KAAM,O,6EC5FnCiC,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACC,EAAOC,GAAI,qCAAsC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,2DAA2D,MAAQ,GAAG,SAAW,kBAAkB,eAAiB,CAAC,kCAAkC,WAAa,MAE9QH,EAAwBI,OAAS,CAChC,MAAS,wBAEV,W,wDCRO,SAAShC,EAAIiC,EAASC,GACzB,OAAO,QAAQ,SAAUC,EAAQC,GAC7B,IAAIC,EAAQ,EACZF,EAAOxB,WAAU,OAAyByB,GAAY,SAAUpB,GAC5DoB,EAAWE,KAAKL,EAAQM,KAAKL,EAASlB,EAAOqB,e,gKCKrDG,EAAU,GAEdA,EAAQC,kBAAoB,IAC5BD,EAAQE,cAAgB,IAElBF,EAAQG,OAAS,SAAc,KAAM,QAE3CH,EAAQI,OAAS,IACjBJ,EAAQK,mBAAqB,IAE7B,IAAIC,EAAS,IAAI,UAASN,GAIxB,IAAK,kBAAkBV,EAAOiB,IAAIC,WAAY,CAC5C,IA+BIC,GAAiB,iBACjBC,EAAYD,EAAgB,EAAc,iBAE9CnB,EAAOiB,IAAII,OACT,MACA,cApCkB,SAAuBC,EAAGC,EAAGJ,GACnD,IAAKG,GAAKC,GAAKD,IAAMC,EACnB,OAAO,EAGT,IAAIC,EAEJ,IAAKA,KAAKF,EACR,KAAIH,GAAuB,YAANK,IAKjBF,EAAEE,KAAOD,EAAEC,GACb,OAAO,EAIX,IAAKA,KAAKD,EACR,KAAIJ,GAAuB,YAANK,GAKhBF,EAAEE,IACL,OAAO,EAIX,OAAO,EAQIC,CAAcL,EAAWD,EAAgB,EAAc,iBAAgBA,IAMtEC,EAAYD,EAAgB,EAAc,iBAE1CH,EAAO,YAPLhB,EAAOiB,IAAIC,gBAYzBlB,EAAOiB,IAAIS,SAAQ,WACjBV,OAMG,QAAe,WAAW,iBAAiB,sBAAiBW","sources":["webpack://@dev/app/../client/src/index.ts","webpack://@dev/app/../mihome/src/containers/index.tsx","webpack://@dev/app/../mihome/src/containers/styles.module.scss","webpack://@dev/app/../../node_modules/rxjs/dist/esm5/internal/operators/map.js","webpack://@dev/app/../mihome/src/containers/styles.module.scss?9390"],"sourcesContent":["import { GraphQLClient } from \"graphql-request\";\nimport { createClient } from \"graphql-ws\";\n\n// https://shammelburg.medium.com/subscriptions-with-graphql-dfa8279af050\n// https://github.com/shammelburg/graphql-rxjs-angular/blob/main/src/app/services/graphql.service.ts\nexport const client = new GraphQLClient(`${location.pathname}graphql`, {\n  headers: {\n    // authorization: `Bearer ${localStorage.getItem('token')}`,\n  },\n});\n\nexport const subscriptions = createClient({\n  url: `${{ \"https:\": \"wss:\" }[location.protocol] || \"ws:\"}//${location.host}${\n    location.pathname\n  }subscriptions`,\n});\n","import React, {\n  type ChangeEventHandler,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\";\nimport { gql } from \"graphql-request\";\nimport { from } from \"rxjs\";\nimport { map } from \"rxjs/operators\";\nimport { client, subscriptions } from \"@dev/client\";\nimport styles from \"./styles.module.scss\";\n\nclass Service {\n  client = client;\n  subscriptions = subscriptions;\n}\n\nconst MIHOME_DEVICES = gql`\n  query MiHomeDevicesQuery($username: String, $password: String) {\n    miHome {\n      devices(username: $username, password: $password)\n    }\n  }\n`;\n\nexport class MiHomeService extends Service {\n  miHomeDevices(data) {\n    return from(this.client.request(MIHOME_DEVICES, data)).pipe(\n      map(({ miHome: { devices } }) => devices)\n    );\n  }\n}\n\nconst service = new MiHomeService();\n\nexport function useService() {\n  const [data, setData] = useState({});\n\n  return {\n    data,\n    miHomeDevices: useCallback(\n      (data) => service.miHomeDevices(data).subscribe((data) => setData(data)),\n      []\n    ),\n  };\n}\n\nexport default function Section() {\n  const [form, setForm] = useState(() => ({\n    username: process.env.MI_USERNAME || \"\",\n    password: process.env.MI_PASSWORD || \"\",\n  }));\n  const { data, miHomeDevices } = useService();\n\n  const handleChange = useCallback<ChangeEventHandler<HTMLFormElement>>(\n    ({ target }) =>\n      setForm((form) => ({\n        ...form,\n        [target.name]: target.value,\n      })),\n    []\n  );\n\n  const handleSubmit = useCallback<ChangeEventHandler<HTMLFormElement>>((e) => {\n    e.preventDefault();\n    miHomeDevices(form);\n  }, []);\n\n  return (\n    <div className={styles.Section}>\n      <h2>MiHome</h2>\n      <form onSubmit={handleSubmit}>\n        <label>\n          <div>username</div>\n          <input\n            name=\"username\"\n            type=\"text\"\n            value={form.username}\n            onChange={handleChange}\n          />\n        </label>\n        <label>\n          <div>password</div>\n          <input\n            name=\"username\"\n            type=\"text\"\n            value={form.password}\n            onChange={handleChange}\n          />\n        </label>\n        <div>\n          <button type=\"submit\">get-devices</button>\n        </div>\n      </form>\n      <pre>{JSON.stringify(data, null, 2)}</pre>\n    </div>\n  );\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".HFznFB7uWtSAYfj1DccE{color:green}\", \"\",{\"version\":3,\"sources\":[\"webpack://./../mihome/src/containers/styles.module.scss\"],\"names\":[],\"mappings\":\"AAAA,sBACE,WAAA\",\"sourcesContent\":[\".Video {\\n  color: green;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"Video\": \"HFznFB7uWtSAYfj1DccE\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function map(project, thisArg) {\n    return operate(function (source, subscriber) {\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            subscriber.next(project.call(thisArg, value, index++));\n        }));\n    });\n}\n//# sourceMappingURL=map.js.map","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./styles.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\nif (module.hot) {\n  if (!content.locals || module.hot.invalidate) {\n    var isEqualLocals = function isEqualLocals(a, b, isNamedExport) {\n  if (!a && b || a && !b) {\n    return false;\n  }\n\n  var p;\n\n  for (p in a) {\n    if (isNamedExport && p === \"default\") {\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n\n    if (a[p] !== b[p]) {\n      return false;\n    }\n  }\n\n  for (p in b) {\n    if (isNamedExport && p === \"default\") {\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n\n    if (!a[p]) {\n      return false;\n    }\n  }\n\n  return true;\n};\n    var isNamedExport = !content.locals;\n    var oldLocals = isNamedExport ? namedExport : content.locals;\n\n    module.hot.accept(\n      \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./styles.module.scss\",\n      function () {\n        if (!isEqualLocals(oldLocals, isNamedExport ? namedExport : content.locals, isNamedExport)) {\n                module.hot.invalidate();\n\n                return;\n              }\n\n              oldLocals = isNamedExport ? namedExport : content.locals;\n\n              update(content);\n      }\n    )\n  }\n\n  module.hot.dispose(function() {\n    update();\n  });\n}\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./styles.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n"],"names":["client","GraphQLClient","location","pathname","headers","subscriptions","createClient","url","protocol","host","MIHOME_DEVICES","gql","service","miHomeDevices","data","from","this","request","pipe","map","miHome","devices","Section","form","setForm","useState","username","password","setData","useCallback","subscribe","useService","handleChange","target","name","value","handleSubmit","e","preventDefault","React","className","styles","onSubmit","type","onChange","JSON","stringify","___CSS_LOADER_EXPORT___","push","module","id","locals","project","thisArg","source","subscriber","index","next","call","options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","update","hot","invalidate","isNamedExport","oldLocals","accept","a","b","p","isEqualLocals","dispose","undefined"],"sourceRoot":""}